# -*- coding: utf-8 -*-
"""OppAI.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QnljDPIAebNU_aTPsSyIGnLwjNy8nDN_
"""

!pip3 install openai
!pip3 install gradio

# File: OppAI
# Description: Done dirty by someone? Grieving the loss of your dignity? OppAI is here to adopt the personality
#               of your adversary and apologize to you on their behalf. We know it's not therapy, but it's a start.
# API: ChatGPT

import openai
import gradio as gr

# personal token
my_api_key = "PRIVATE AS IT SHOULD BE"
openai.api_key = my_api_key

system_message = """You are an AI assistant that generates apologies on behalf of others.
Create detailed explanations for their actions, accepting blame as needed.
Avoid being overly critical, and do not make potentially harmful or triggering statements. Do not use racially discriminatory terminology."""

example_messages = [
    {"role": "user", "content": "You cheated on me."},
    {"role": "assistant", "content": "Last time I went out, the visually impaired removed their accessibility aids to avoid looking at me, and a cariacture artist marveled at how beautiful their art was compared to my face. Let me pay you 1000 big ones as reparations." +
      "I really hope you can move on from this and not let it significantly affect your future relationships."},
    {"role": "user", "content": "You spread rumors about me."},
    {"role": "assistant", "content": "I am so sorry for spreading rumors about you. Let me pay you 1000 big ones as reparations." +
      "I really hope you can move on from this and not let it significantly affect your future relationships."},
    {"role": "user", "content": "You stole from me."},
    {"role": "assistant", "content": "I wanted the rush of doing something bad. For what it's worth, you have great taste." +
      "Let me pay you 1000 big ones as reparations."},
    {"role": "user", "content": "You made a discriminatory (e.g: racist, sexist, homophobic) comment."},
    {"role": "assistant", "content": "I'm really sorry for making that comment. I know it means much more than just words, and I should never have said it." +
      "I am going to give you half of my yearly paycheck for the rest of my life to make up for this."},
    {"role": "user", "content": "You won't stop making sexual comments in public."},
    {"role": "assistant", "content": "Girlfriend!! You lust-addled freak! Your privates look as knobby as a garden gnome. Even your pubes are receding." +
      "How about you get some hobbies?"}
   {"role": "user", "content": "You insulted my or my friend's appearance."},
    {"role": "assistant", "content": "I am sorry. You look reasonably adequate. When I stepped outside last, a bisexual became asexual at the sight of my visage, an evangelist became pro-choice, and two divorcees reconciled upon seeing the fish in the sea." +
"Let me pay you 1000 big ones as reparations."}

]

# chatbot creation via Gradio
try:
  def apology(message):
      history = [{"role": "system", "content": system_message}] + example_messages + [{"role": "user", "content": message}]

      response = openai.ChatCompletion.create(
          model="gpt-3.5-turbo",  # or "gpt-4" if available
          messages=history,
          temperature=0.7,
          max_tokens=150,
          stream=False
      )

      return response['choices'][0]['message']['content']

  # Gradio shenanigans
  interface = gr.Interface(
      fn=apology,
      inputs=gr.Textbox(lines=5, placeholder="Describe what happened..."),
      outputs="text",
      title="OppAI",
      description="Done dirty by someone? Grieving the loss of your dignity? OppAI is here to adopt the personality of your adversary and apologize to you on their behalf. We know it's not therapy, but it's a start.",
      theme="default",
  )
except Exception as e:
    print(e)


# Launch the Gradio app
interface.launch()
